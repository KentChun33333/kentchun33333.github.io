
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://kentchun33333.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://kentchun33333.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://kentchun33333.github.io/theme/font-awesome/css/font-awesome.min.css">





  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Kent Chiu" />
<meta name="description" content="Introduction¶To install CUDA is painful for most of people since most of data scientists or deep learning researchers are not familiar with system-side knowledge, include me. Few monthes ago, I've successed install CUDA in WINDOWS system, however, for some reasons, the WINDOWS-based version is no longer to satisfited my need." />
<meta name="keywords" content="env, cuda, ubuntu">
<meta property="og:site_name" content="Autumn Memo"/>
<meta property="og:title" content="Install CUDA in Ubuntu 14.04"/>
<meta property="og:description" content="Introduction¶To install CUDA is painful for most of people since most of data scientists or deep learning researchers are not familiar with system-side knowledge, include me. Few monthes ago, I've successed install CUDA in WINDOWS system, however, for some reasons, the WINDOWS-based version is no longer to satisfited my need."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://kentchun33333.github.io/InstallCUDAUbuntu.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-11-10 18:00:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://kentchun33333.github.io/author/kent-chiu.html">
<meta property="article:section" content="AI"/>
<meta property="article:tag" content="env"/>
<meta property="article:tag" content="cuda"/>
<meta property="article:tag" content="ubuntu"/>
<meta property="og:image" content="https://kentchun33333.github.io/image/profile.png">

  <title>Autumn Memo &ndash; Install CUDA in Ubuntu 14.04</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://kentchun33333.github.io">
        <img src="https://kentchun33333.github.io/image/profile.png" alt="Kent Chiu" title="Kent Chiu">
      </a>
      <h1><a href="https://kentchun33333.github.io">Kent Chiu</a></h1>

<p>Data Scientist</p>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/kent-chiu-93b745a2?trk=hp-identity-photo" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/KentChun33333" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-facebook" href="https://www.facebook.com/kent.chun" target="_blank"><i class="fa fa-facebook"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://kentchun33333.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
    <h1 id="InstallCUDAUbuntu">Install CUDA in Ubuntu 14.04</h1>
    <p>
          Posted on Thu 10 November 2016 in <a href="https://kentchun33333.github.io/category/ai.html">AI</a>


    </p>
  </header>


  <div>
    
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h3><p>To install CUDA is painful for most of people since most of data scientists or deep learning researchers are not familiar with system-side knowledge, include me. Few monthes ago, I've successed install CUDA in WINDOWS system, however, for some reasons, the WINDOWS-based version is no longer to satisfited my need.</p>
<p><strong>I decided to switch my whole inframe-structure to Ubuntu 14.04 LTS.</strong></p>
<p>It took me almost 8 hours to sucessfully recover all my base-environment, and the most painful step is to install CUDA. Therefore, I decide to share my sucessful process step-by-step. Hope it will help some people : )</p>
<h3 id="Step-1-:-Pre-installation-just-follow-officail-guild">Step 1 : Pre-installation just follow <a href="http://developer.download.nvidia.com/compute/cuda/8.0/secure/prod/docs/sidebar/CUDA_Installation_Guide_Linux.pdf?autho=1478535150_deefbbf1f764ec2a59a02727d0c95c05&amp;file=CUDA_Installation_Guide_Linux.pdf">officail guild</a><a class="anchor-link" href="#Step-1-:-Pre-installation-just-follow-officail-guild">¶</a></h3><ul>
<li><p>update apt-get</p>
</li>
<li><p>install GCC G++</p>
</li>
<li><p>sudo apt-get install linux-headers-$(uname -r)</p>
</li>
<li><p>sudo apt-get install build-essential</p>
</li>
<li><p>Download your relevant CUDA.run file such as <strong>cuda_8.0.44_linux.run</strong> and chmod 777 it</p>
</li>
</ul>
<h3 id="Step-2-:-depreciate-nouveau-since-it-will-cause-confiction-with-Nvidia-driver">Step 2 : depreciate nouveau since it will cause confiction with Nvidia-driver<a class="anchor-link" href="#Step-2-:-depreciate-nouveau-since-it-will-cause-confiction-with-Nvidia-driver">¶</a></h3><p>Create the /etc/modprobe.d/blacklist-nouveau.conf file with :</p>
<ul>
<li><p>blacklist nouveau</p>
</li>
<li><p>options nouveau modeset=0</p>
</li>
</ul>
<p>Then</p>
<ul>
<li><p>sudo update-initramfs -u</p>
</li>
<li><p>Reboot computer to initialize this setting.</p>
</li>
</ul>
<h3 id="Step-3-:-Do-the-Nvidia-Driver-and-CUDA-installation-in-TTY1-(Ctrl-+-Alt-+-F1).">Step 3 : Do the Nvidia-Driver and CUDA installation in TTY1 (Ctrl + Alt + F1).<a class="anchor-link" href="#Step-3-:-Do-the-Nvidia-Driver-and-CUDA-installation-in-TTY1-(Ctrl-+-Alt-+-F1).">¶</a></h3><p>After reboot, we have to stop any service that is realted to X-server.</p>
<ul>
<li><p>sudo service lightdm stop</p>
</li>
<li><p>sudo bash cuda-8.0.44_linux.run --no-opengl-libs <strong>(the flag is critial)</strong></p>
</li>
<li><p>Accept all setting except the Xserver configuration. <strong>NO for Xserver configurations.</strong></p>
</li>
<li><p>(OPTIONAL) sudo modprobe nvidiah</p>
</li>
</ul>
<p>Set Environment path variables in .bashrc and then source it:</p>
<ul>
<li><p>export PATH=/usr/local/cuda-8.0/bin:$PATH</p>
</li>
<li><p>export LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64:$LD_LIBRARY_PATH</p>
</li>
</ul>
<h3 id="Step-4-:-Installation-Cudnn">Step 4 : Installation Cudnn<a class="anchor-link" href="#Step-4-:-Installation-Cudnn">¶</a></h3><p>Download Cudnn with right version with your cuda and os-arch</p>
<ul>
<li><p>Download : cudnn-8.0-linux-x64-v5.0-ga.tgz <strong>(depend on your version)</strong> and unzip it.</p>
</li>
<li><p>After unzip it, you will find a cuda folder with 2 subfolder lib64 and include</p>
</li>
</ul>
<p>Copy the file from cudnn into the original-CUDA with the corresponding folder</p>
<ul>
<li><p>cd cuda/lib64 & sudo cp ./* /usr/local/cuda/lib64/</p>
</li>
<li><p>cd cuda/include & sudo cp cudnn.h /usr/local/cuda/include/</p>
</li>
</ul>
<p>Clean and Create right link for cudnn .so, Notice following .so versions are actually depend on your version :</p>
<ul>
<li><p>cd /usr/local/cuda/lib64/ & sudo rm -rf libcudnn.so libcudnn.so.5</p>
</li>
<li><p>sudo ln -s libcudnn.so.5.0.5 libcudnn.so.5</p>
</li>
<li><p>sudo ln -s libcudnn.so.5 libcudnn.so</p>
</li>
<li><p>OPTIONAL (sudo ln -s /usr/local/cuda/lib64/libcufft.so /usr/lib/libcufft.so)</p>
</li>
</ul>
<h3 id="Finally">Finally<a class="anchor-link" href="#Finally">¶</a></h3><p>Once we finished the installation, we could re-opend <strong>lightdm</strong>, or simpliy reboot, and then do the rest of things such as install Torch/Tensorflow/Mxnet/OpenCV ....etc.</p>
<p>If you are a user of tensorflow, we could have a test on it with following code : )</p>
<p>Good Luck!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tensorflow-Attention">Tensorflow Attention<a class="anchor-link" href="#Tensorflow-Attention">¶</a></h1><p>$\text{Update @2016-11-09}$</p>
<p>Since the Tensorflow is compiled with default cudnn version, if your cudnn version is not as the default, <strong>you need to install tensorflow from souce.</strong></p>
<p><strong>First : remove tensorflow flow if you already have. For my case : </strong></p>
<div class="highlight"><pre><span></span>sudo ~/anaconda2/bin/pip show tensorflow
sudo ~/anaconda2/bin/pip uninstall tensorflow
</pre></div>
<p><strong> Second : install bazel & relative dependency </strong></p>
<div class="highlight"><pre><span></span>apt-get install software-properties-common swig
sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java8-installer
<span class="nb">echo</span> <span class="s2">"deb http://storage.googleapis.com/bazel-apt stable jdk1.8"</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/bazel.list

curl https://storage.googleapis.com/bazel-apt/doc/apt-key.pub.gpg <span class="p">|</span> sudo apt-key add -
sudo apt-get update

sudo apt-get install bazel
</pre></div>
<p><strong> Third : build a .whl file of tensorflow with bazel. </strong></p>
<div class="highlight"><pre><span></span>git clone https://github.com/tensorflow/tensorflow

<span class="nb">cd</span> tensorflow/  
<span class="c1"># Do not reset the header     </span>

./configure 

bazel build -c opt --config<span class="o">=</span>cuda //tensorflow/tools/pip_package:build_pip_package

<span class="c1"># Make sure using right version of pip</span>
sudo ~/anaconda2/bin/pip install ~/github/tensorflow/bazel-bin/tensorflow/tools/pip_package/build_pip_package 

bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg

sudo ~/anaconda2/bin/pip install /tmp/tensorflow_pkg/tensorflow-0.11.0rc2-cp27-cp27mu-linux_x86_64.whl
</pre></div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://kentchun33333.github.io/tag/env.html">env</a>
      <a href="https://kentchun33333.github.io/tag/cuda.html">cuda</a>
      <a href="https://kentchun33333.github.io/tag/ubuntu.html">ubuntu</a>
    </p>
  </div>




<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https-kentchun33333-github-io';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; Kent Chiu </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Autumn Memo ",
  "url" : "https://kentchun33333.github.io",
  "image": "https://kentchun33333.github.io/image/profile.png",
  "description": "Memos from authors, if it is helpful, please consider support me, thank you so ~ much !"
}
</script>
</body>
</html>